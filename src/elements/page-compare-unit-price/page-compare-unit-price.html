<link rel="import" href="../../bower-assets/paper-card/paper-card.html">
<link rel="import" href="../../bower-assets/paper-input/paper-input.html">
<link rel="import" href="../../bower-assets/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../bower-assets/paper-menu/paper-menu.html">
<link rel="import" href="../../bower-assets/paper-item/paper-item.html">
<link rel="import" href="../../bower-assets/paper-tabs/paper-tabs.html">
<link rel="import" href="../../bower-assets/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower-assets/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../bower-assets/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../bower-assets/vaadin-date-picker/vaadin-date-picker.html">

<link rel="import" href="../../bower-assets/vaadin-grid/vaadin-grid.html">
<link rel="import" href="../../bower-assets/vaadin-grid/vaadin-grid-sorter.html">
<link rel="import" href="../../bower-assets/paper-spinner/paper-spinner.html">
<link rel="import" href="../../bower-assets/paper-tooltip/paper-tooltip.html">

<!-- Custom AutoComplete -->
<link rel="import" href="../../bower-assets/paper-autocomplete/paper-autocomplete.html">
<link rel="import" href="../../bower-assets/vaadin-combo-box/vaadin-combo-box.html">
<link rel="import" href="../../bower-assets/vaadin-grid/vaadin-grid.html">
<link rel="import" href="../../bower-assets/vaadin-grid/vaadin-grid-column.html">
<link rel="import" href="../../bower-assets/vaadin-grid/vaadin-grid-filter.html">

<!-- style -->
<link rel="import" href="../../styles/common-style.html">

<!-- behavior -->
<link rel="import" href="../../behaviors/db-using.html">
<link rel="import" href="../../behaviors/translating.html">
<link rel="import" href="../../behaviors/page-like.html">
<link rel="import" href="../../behaviors/api-calling.html">
<link rel="import" href="../../behaviors/common-computes.html">



<dom-module id="page-compare-unit-price">
  <template>

    <!-- style -->
    <style is="custom-style" include="common-style">
      app-header-layout ::content #contentContainer {
        overflow: hidden !important;
      }

      :host {
        height: 100%;
        position: absolute;
        left: 0;
        right: 0;
        top: 0;
      }

      .container {
        width: 100%;
        height: inherit;
        position: relative;
        /* background-color: #fff; */
      }

      .top-container {
        /* background-color: #f3f5f7; */
        box-shadow:rgba(0, 0, 0, .54) 0 -10px 6px -10px inset;
        height: 310px;
      }

      #filter {
        /* padding: 8px 8px 16px 8px; */
        background-color: #f3f5f7;
        position: relative;
      }

      .filter {
        padding: 0 6px 1px 6px;
      }


      .custom-input {
        padding-top: 6px;
        padding-bottom: 6px;
      }

      .custom-flat-button {
        font-weight: bold;
        font-size: 14px;
        text-transform: uppercase;
      }

      #importResult {
        overflow-y: scroll;
        height: 200px;
        background: white;
        padding: 12px;
        margin-top: 16px;
      }

      .type.capton-2 {
        line-height: 25px;
      }

      .left {
        width: 30%;
      }
      .right {
        width: 100%;
        height: inherit;
      }

      @media screen and (max-width: 859px) {
        .left, .right {
          width: 100%;
        }
      }

      @media screen and (max-width: 639px) {
        .editor {
          width: 100% !important;
          right: -100%;
        }
        .open {
          right: 0;
        }
      }

      @media screen and (max-width: 479px) {
        .filter-input {
          width: 100%;
        }

        #btnFilter {
          margin-top: 8px;
          margin-bottom: 8px;
        }
      }

      .container {
        width: 100%;
        height: 100%;
        /* background-color: #fff; */
      }


      .fixed-title {
        position: absolute;
        top: 0;
        left: 0;
        padding: 12px 8px 11px 12px;
        border-bottom: 1px solid #eee;
        z-index: 1;
        background-color: #fafafa;
        width: calc( 100% - 24px);
      }

      vaadin-combo-box-light {
        width: 100%;
        box-sizing: border-box;
      }

      .filter-input-2  {
        border: none;
        background-color: #eee;
        font-size: 16px;
        font-weight: 500;
        width: 100%;
        box-sizing: border-box;
        padding: 6px 8px;
        border-radius: 6px;
        outline: none;
      }

      .filter-input  {
        border: none;
        background-color: inherit;
        font-size: 20px;
        /* height: 100%; */
        /* padding: 12px 16px; */
        width: 100%;
        /* text-align: center; */
        outline: none;
      }

      .custom-button {
        padding: 0.4em 1em;
        font-size: 16px;
        line-height: 24px;
        background-color: #fff;
      }

      #ItemSearch {
        /* padding: 12px 16px; */
        /* background-color: #fafafa; */
      }

      #ItemSearch {
        color: #fff;
      }

      #ItemSearch ::content input{
        font-size: 20px;
        color: #fff;
      }

      #ItemSearch ::content #label{
        font-size: 20px;
        color: rgba(255, 255, 255, .54) !important;
      }

      #ItemSearch ::content .underline{
        display: none;
      }

      #ItemSearch ::content iron-icon{
        color: #fff !important;
      }

      /* #ItemSearch ::content .clear-button {
        display: none;
      }

      #ItemSearch ::content .toggle-button {
        display: none;
      } */

      .top-bar {
        background-color: var(--brand-primary-color);
        height: 56px;
        box-sizing: border-box;
        padding: 0 16px;
        width: 100%;
        /* text-align: center; */
        color: #fff;
        box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
      }

      .advance-search {
        background: #fff;
        /* padding: 8px 8px 8px 16px; */
      }

      .filter-label-list {
        /* padding: 4px 8px; */
        background-color: #fff;
      }

      .filter-label {
        border-radius: 18px;
        background: #eee;
        padding-left: 8px;
        margin: 4px 6px;
      }

      .btn-icon-small {
        height: 20px;
        width: 20px;
        padding: 1px;
        text-align: center;
      }

      .btn-icon-small ::content iron-icon {
        height: 16px;
        width: 16px;
      }

      .no-results {
        background: #fafafa;
        height: 100%;
        width: 100%;
      }

      .table-icon {
        height: 20px;
        width: 20px;
      }

      .filter-paper-input ::content paper-input-container {
        padding: 0 !important;
      }

      .custom-paper-input {
        width: 100%;
      }

      .custom-paper-input ::content .underline {
        display: none;
      }

      .custom-paper-input ::content paper-input-container {
        padding-bottom: 0;
      }
      .custom-paper-input ::content input {
        font-weight: bold !important;
        background-color: #00968840 !important;
        padding: 4px 8px;
        box-sizing: border-box !important;
        border-radius: 6px !important;
        padding-left: 12px !important;
      }

      .custom-paper-input ::content input::placeholder {
        color: rgba(0, 0, 0, .87) !important;
      }

      .paper-custom-input ::content input::placeholder {
        color: rgba(0,0,0, .76) !important;
      }

      .search-area {
        background-color: #009688;
        box-sizing: border-box;
        padding: 8px;
      }

      #loginBtn {
        padding: 0.4em 2em;
        font-size: 16px;
        background-color: #fff;
        color: black;
      }

      

      .editor {
        top: 56px !important;
        width: 50%;
        border-top-left-radius: 6px;
        /* right: -50%; */
      }

    </style>

    <div class="container">
      <div class="top-bar horizontal layout center">
        <div class="type headline flex">BDEMR - Compare product unit price</div>
        
        <!-- <paper-button id="loginBtn" on-tap="_goLoginPage" raised>Login</paper-button> -->
        
      </div>

      <div class="search-area">

        <div class="horizontal layout wrap center">
          <vaadin-combo-box allow-custom-value no-label-float items="{{categoryList}}" class="m-horizontal-4 paper-custom-input flex" placeholder="[[$TRANSLATE('Select Category',LANG)]]" value="{{filterBy.category}}" on-selected-item-changed="categorySelected"></vaadin-combo-box>
          <!-- <paper-input class="paper-custom-input flex m-horizontal-4" label="Country" value="{{filterBy.effectiveRegion}}"></paper-input> -->
          <vaadin-combo-box allow-custom-value no-label-float items="{{districtlist}}" class="m-horizontal-4 paper-custom-input flex" placeholder="[[$TRANSLATE('Filter by Location/Address',LANG)]]" value="{{filterBy.address}}"></vaadin-combo-box>
          <vaadin-combo-box no-label-float items="{{organizationList}}" class="m-horizontal-4 paper-custom-input flex" placeholder="[[$TRANSLATE('Select Organization',LANG)]]" value="{{filterBy.organizationId}}" item-value-path="id" item-label-path="name" ></vaadin-combo-box>
          <!-- <paper-button class="custom-button" raised on-tap="_onfilterModalClearAll">Clear Filter</paper-button> -->
        </div>
        
        <div class="horizontal layout center">
          <!-- <vaadin-combo-box allow-custom-value no-label-float autofocus items="{{matchingItemKeys}}" id="ItemSearch" class="flex paper-custom-input m-horizontal-4" placeholder="Type & Select Product name..." filter="{{searchQuery}}" loading="[[fetchingItemSearchResult]]" on-selected-item-changed="_onSelectedItemChanged" value="">
          </vaadin-combo-box>       -->
          
          <paper-input no-label-float class="flex paper-custom-input m-horizontal-4" placeholder="[[$TRANSLATE('Type & Select Product name...',LANG)]]" value="{{filterBy.name}}"></paper-input>
            
        </div>

        <paper-button raised class="custom-button" on-tap="_onTapSearch">
          <iron-icon icon="search" class='m-right-8'></iron-icon>[[$TRANSLATE('Search',LANG)]]
        </paper-button>

  
        <!-- <paper-icon-button  icon="icons:sort" on-tap="_showFilterOptions"></paper-icon-button> -->
      </div>

      
      
      <!-- <div class="filter-label-list horizontal layout wrap">
        <template is="dom-if" if="{{filterBy.category}}">
          <div class="filter-label horizontal layout center">
            <div class="type caption-2 secondary flex"><strong>Category: </strong>{{filterBy.category}}</div>
            <paper-icon-button class="btn-icon-small" icon="close" on-tap="_onTapClearCategoryFilter"></paper-icon-button>
          </div>
        </template>
  
        <template is="dom-if" if="{{filterBy.effectiveRegion}}">
          <div class="filter-label horizontal layout center">
            <div class="type caption-2 secondary flex"><strong>Region: </strong>{{filterBy.effectiveRegion}}</div>
            <paper-icon-button class="btn-icon-small" icon="close" on-tap="_onTapClearEffectiveRegionFilter"></paper-icon-button>
          </div>
        </template>
  
        <template is="dom-if" if="{{filterBy.address}}">
          <div class="filter-label horizontal layout center">
            <div class="type caption-2 secondary flex"><strong>Location: </strong>{{filterBy.address}}</div>
            <paper-icon-button class="btn-icon-small" icon="close" on-tap="_onTapClearLocationFilter"></paper-icon-button>
          </div>
        </template>
          
      </div> -->

      <!-- <template is="dom-if" if="{{$isEmptyArray(matchingResults.length)}}">
        <div class="no-results horizontal layout center center-justified">
          <div class="type secondary body"><i>-- no data available --</i></div> 
        </div>
      </template> -->

      <template is="dom-if" if="{{loading}}">
        <div class="no-results horizontal layout center center-justified">
          <paper-spinner active></paper-spinner>
        </div>
      </template>

      <vaadin-grid class="custom-vaadin-grid" items="{{matchingResults}}" id="list" active-item="{{activeItem}}">

        <!-- <vaadin-grid-column width="60px" frozen>
          <template class="header">No.</template>
          <template>[[$returnSerial(index)]]</template>
        </vaadin-grid-column> -->

        <!-- <vaadin-grid-column width="12em">
          <template class="header">
            <div>Country</div>
            <vaadin-grid-filter aria-label="Date" path="effectiveRegion" value="[[effectiveRegionFilter]]">
              <paper-input class="custom-paper-input" no-label-float value="{{effectiveRegionFilter}}"></paper-input>
            </vaadin-grid-filter>
            
          </template>
          <template>
            [[item.effectiveRegion]]
          </template>
        </vaadin-grid-column> -->

        <!-- <vaadin-grid-column width="12em">
          <template class="header">
            <div>Category</div>
            <vaadin-grid-filter  aria-label="Category" path="category" value="[[categoryFilter]]">
              <paper-input class="custom-paper-input" no-label-float placeholder="" value="{{categoryFilter}}"></paper-input>
            </vaadin-grid-filter>
          </template>
          <template>
            [[item.category]]
          </template>
        </vaadin-grid-column> -->


        <vaadin-grid-column width="16em" frozen>
          <template class="header">
            <!-- <div>Product Name</div> -->
            <vaadin-grid-filter  aria-label="Product Name" path="name" value="[[nameFilter]]">
              <paper-input class="custom-paper-input" no-label-float placeholder="[[$TRANSLATE('Product Name',LANG)]]" value="{{nameFilter}}"></paper-input>
            </vaadin-grid-filter>
          </template>
          <template>
            
            <div class="horizontal layout wrap center">
              <!-- <iron-icon class="m-right-8 table-icon" src$="{{_getCategoryIcon(item.category)}}"></iron-icon> -->
              <div class="flex">
                <div>[[item.name]]</div>
                <div class="type capton-2 secondary"><i>[[item.genericName]]</i></div>
              </div>
              <paper-tooltip position="top" for="item-{{index}}" offset="0">{{item.category}}</paper-tooltip>
            </div>
            
          </template>
        </vaadin-grid-column>

        
        <vaadin-grid-column width="12em" hidden$="{{hideAuthorColumn}}">
          <template class="header">
            <!-- <div>Author Name</div> -->
            <vaadin-grid-filter  aria-label="Author Name" path="authorName" value="[[authorNameFilter]]">
              <paper-input class="custom-paper-input" placeholder="[[$TRANSLATE('Author Name',LANG)]]" no-label-float placeholder="" value="{{authorNameFilter}}"></paper-input>
            </vaadin-grid-filter>
          </template>
          <template>
            [[item.authorName]]
          </template>
        </vaadin-grid-column>

        <vaadin-grid-column width="4em">
          <template class="header">
            <vaadin-grid-sorter path="price" direction="asc">
              <div>[[$TRANSLATE('Price/Rate/Number',LANG)]]</div>
            </vaadin-grid-sorter>
          </template>
          <template>
            [[item.price]]
          </template>
        </vaadin-grid-column>

        <vaadin-grid-column width="12em">
          <template class="header">
            <span style="color: rgb(252, 101, 126);">[[$TRANSLATE('Deal',LANG)]]</span>
          </template>
          <template>
            <span style="color: rgb(252, 101, 126);"> [[item.dealDetails]]</span>
          </template>
        </vaadin-grid-column>

        <vaadin-grid-column width="5em">
          <template class="header">
            [[$TRANSLATE('Qty Available',LANG)]]
          </template>
          <template>
            [[item.quantity]]
          </template>
        </vaadin-grid-column>

        <vaadin-grid-column width="6em">
          <template class="header">
            [[$TRANSLATE('Valid Until',LANG)]]
          </template>
          <template>
            [[item.expiredDate]]
          </template>
        </vaadin-grid-column>

        <vaadin-grid-column width="12em">
          <template class="header">
            <!-- <div>Shelf/Location</div> -->
            <vaadin-grid-filter aria-label="Shelf/Location" path="location" value="[[locationFilter]]">
              <paper-input class="custom-paper-input" no-label-float placeholder="[[$TRANSLATE('Shelf/Location',LANG)]]" value="{{locationFilter}}"></paper-input>
            </vaadin-grid-filter>
          </template>
          <template>
            [[item.location]]
          </template>
        </vaadin-grid-column>

        <vaadin-grid-column width="12em">
          <template class="header">
            <!-- <div>Organization</div> -->
            <vaadin-grid-filter  aria-label="Organization" path="organizationName" value="[[organizationNameFilter]]">
              <paper-input class="custom-paper-input" placeholder="[[$TRANSLATE('Organization',LANG)]]" no-label-float placeholder="" value="{{organizationNameFilter}}"></paper-input>
            </vaadin-grid-filter>
          </template>
          <template>
            [[item.organizationName]]
          </template>
        </vaadin-grid-column>

        <!-- <vaadin-grid-column width="12em">
          <template class="header">
            Description
          </template>
          <template>
            [[item.description]]
          </template>
        </vaadin-grid-column> -->


        <!-- <vaadin-grid-column width="12em">
          <template class="header">
            Address
          </template>
          <template>
            [[item.address]]
          </template>
        </vaadin-grid-column> -->

        <!-- <vaadin-grid-column width="12em">
          <template class="header">
            Contact Number
          </template>
          <template>
            [[item.contactNumber]]
          </template>
        </vaadin-grid-column> -->

        <!-- <vaadin-grid-column width="12em">
          <template class="header">
            Url
          </template>
          <template>
            <a href$="[[item.url]]" target="_blank">[[item.url]]</a>
          </template>
        </vaadin-grid-column> -->

        <!-- <template is="dom-repeat" items="{{item.otherFields}}" as="custom" index-as="customIndex">
          <vaadin-grid-column width="8em">
            <template class="header">
              {{custom.label}}
            </template>
            <template>
              {{custom.value}}
            </template>
          </vaadin-grid-column>
        </template> -->

        <!-- <vaadin-grid-column width="16em">
          <template class="header">
            Other Details
          </template>
          <template>
            <ul>
              <template is="dom-repeat" items="{{item.otherFields}}" as="custom" index-as="customIndex">
                <li><strong>[[custom.label]]: </strong> [[custom.value]]</li>
              </template>
            </ul>
            
          </template>
        </vaadin-grid-column> -->

      </vaadin-grid>
    </div>

    <div id="editor" class$="editor {{editorHasOpened(hideEditForm)}}">

      <div class="fixed-title horizontal layout center">
        <div class="flex">
          <!-- <h2><span hidden$="{{!EDIT_MODE}}">Edit</span>
            <span hidden$="{{EDIT_MODE}}">New</span> Roster
          </h2> -->
          <h2>[[product.name]]</h2>
          <div class="type body-lead">[[$TRANSLATE('Price',LANG)]]: [[product.price]]</div>
        </div>
        <paper-icon-button icon="close" on-tap="_closeModalView"></paper-icon-button>
        
      </div>

      <div class="editor-content">
        <div class="type body horizontal layout wrap">
          <div class="flex one m-horizontal-4">[[$TRANSLATE('Organization',LANG)]]: </div>
          <div class="flex one m-horizontal-4">{{product.organizationName}}</div>
        </div>
        <div class="type body horizontal layout wrap">
          <div class="flex one m-horizontal-4">[[$TRANSLATE('Vendor Name',LANG)]]: </div>
          <div class="flex one m-horizontal-4">{{product.vendorName}}</div>
        </div>
        <div class="type body horizontal layout wrap">
          <div class="flex one m-horizontal-4">[[$TRANSLATE('Valid Until',LANG)]]: </div>
          <div class="flex one m-horizontal-4">{{product.expiredDate}}</div>
        </div>

        <template is="dom-repeat" items="{{product.otherFields}}" as="other">
          <div class="type body horizontal layout wrap">
            <div class="flex one m-horizontal-4">{{other.label}}: </div>
            <div class="flex one m-horizontal-4">{{other.value}}</div>
          </div>
        </template>

        <div hidden$="{{!product.dealDetails}}" class="m-top-8">
          <div class="type body-lead">[[$TRANSLATE('Deal',LANG)]]:</div>
          <div class="type body">{{product.dealDetails}}</div>
        </div>

        <div hidden$="{{!product.address}}" class="m-top-8">
          <div class="type body-lead">[[$TRANSLATE('Address',LANG)]]:</div>
          <div class="type body">{{product.address}}</div>
        </div>
        
        <div hidden$="{{!product.url}}" class="m-top-8">
          <div class="type body-lead">[[$TRANSLATE('Product Link',LANG)]]:</div>
          <a href$="[[product.url]]" target="_blank">[[product.url]]</a>
        </div>
        
      </div>

    </div>

  </template>

  <script src="page-compare-unit-price.coffee-compiled.js"></script>
</dom-module>